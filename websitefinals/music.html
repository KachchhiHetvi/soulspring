<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Whispers Of Soul</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Courier New', monospace;
      background-color: #fbefdb;
      color: #000000;
      overflow-x: hidden;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4b484' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }
    
    header {
      background-color: #73c375;
      padding: 0px 0;
      border-bottom: 3px solid #558b2f;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      
    }
    
    h1 {
      font-family: 'Dancing Script', cursive;
      margin: 0;
      font-size: 3rem;
      color: #fdfdfd;
      text-shadow: 3px 3px 0 #0a2f02;
      letter-spacing: 2px;
    }
    
    .subtitle {
      padding-top: 5px;
      font-size: 1.2rem;
      color: #f7f3ec;
      font-style: italic;
      font-weight: bold;
      letter-spacing: 2px;
      text-shadow: 3px 2px 0 #0a2f02;
    }
    
    /* Improved layout with shelf on side */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      display: flex;
      gap: 30px;
    }
    
    .player-container {
      flex: 1;
      min-width: 0;
    }
    
    .shelf-container {
      width: 400px;
      flex-shrink: 0;
    }
    
    /* Improved vertical shelf styles */
    .shelf {
      background: linear-gradient(135deg, #a8e6cf, #dcedc1);
      height: calc(100vh - 300px);
      padding: 20px;
      overflow-y: auto;
      box-shadow: -10px 0 10px -5px rgba(0, 0, 0, 0.8), inset -20px 0 0 -10px #102512;
      position: relative;
      border-radius: 10px;
      margin-bottom: 20px;
      min-height: 615px;
    }
    
    .shelf:before {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: -20px;
      width: 20px;
      background-color: #02260b;
      border-radius: 8px 0 0 8px;
    }
    
    /* Albums container */
    .albums-container {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 30px;
      flex-direction: column;
      align-items: center;
    }
    
    .album {
      width: 150px;
      height: 140px;
      margin: 0 auto;
      background-color: #000000;
      cursor: pointer;
      position: relative;
      box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.9);
      transition: transform 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 14px;
      text-align: center;
      border-radius: 5px;
      padding: 5px;
      background-size: cover;
      background-position: center;
    }
    
    .album-overlay {
      background: rgba(0, 0, 0, 0.7);
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 8px;
      border-radius: 0 0 5px 5px;
    }
    
    .album:hover {
      transform: translateY(-5px) scale(1.03);
    }
    
    .album.dragging {
      opacity: 0.5;
    }
    
    .remove-button {
      position: absolute;
      top: 5px;
      right: 5px;
      background-color: #218b13;
      color: #f4e1c1;
      border: none;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
      z-index: 10;
    }
    
    .album:hover .remove-button {
      opacity: 1;
    }
    
    /* Enhanced Player Styles */
    .player {
      background-color: #577458;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 25px;
      box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.84), 0 5px 10px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
    }
    
    .player-cabinet {
      width: 100%;
      position: relative;
      padding: 20px;
      background: url('https://i.pinimg.com/736x/5b/02/7d/5b027d5ad305713a1ab49f4707501962.jpg');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center ;
      border-radius: 10px;
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.6);
    }
    
    .turntable-base {
      width: 340px;
      height: 340px;
      background-image: url('https://atlanticwoodworkers.ca/newsite/wp-content/uploads/2014/11/wood03.jpg');
      border-radius: 15px;
      position: relative;
      margin: 0 auto 30px;
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      padding: 20px;
    }
    
    .platter {
      width: 300px;
      height: 300px;
      background: radial-gradient(#333333, #222222);
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }
    
    .platter:before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      border-radius: 50%;
      background: repeating-radial-gradient(
        circle,
        #333333,
        #333333 1px,
        #222222 1px,
        #222222 2px
      );
      opacity: 0.4;
      z-index: 11;
    }
    
    .record {
      width: 280px;
      height: 280px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      background-color: #111;
      background-size: cover;
      background-position: center;
      z-index: 12;
      transition: transform 0.5s ease-out;
    }
    
    .record:before {
      content: "";
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: repeating-radial-gradient(
        circle,
        #111,
        #111 2px,
        #222 2px,
        #222 4px
      );
      opacity: 0.5;
      z-index: 13;
    }
    
    .record-label {
      width: 90px;
      height: 90px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      z-index: 14;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
      border: 1px solid #000;
    }
    
    .spindle {
      width: 8px;
      height: 8px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #999;
      border-radius: 50%;
      z-index: 15;
      box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
    }
    
    .turntable-arm-base {
      position: absolute;
      top: 25%;
      right: 5%;
      width: 50px;
      height: 50px;
      background-color: #020500;
      border-radius: 50%;
      z-index: 20;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
    }
    
    .turntable-arm {
      position: absolute;
      width: 160px;
      height: 10px;
      background-color: #aaa;
      top: 40px;
      right: 28px;
      transform-origin: right center;
      transform: rotate(-30deg);
      transition: transform 1s cubic-bezier(0.23, 1, 0.32, 1);
      z-index: 21;
      box-shadow: 0 2px 3px rgba(0, 0, 0, 0.3);
      border-radius: 2px;
    }
    
    .arm-head {
      position: absolute;
      width: 12px;
      height: 20px;
      background-color: #888;
      left: 2px;
      top: -5px;
      border-radius: 3px;
      transform: rotate(30deg);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
    }
    
    .needle {
      position: absolute;
      width: 2px;
      height: 6px;
      background-color: #ccc;
      bottom: -4px;
      left: 4px;
      transform: rotate(-10deg);
    }
    
    .counterweight {
      position: absolute;
      width: 20px;
      height: 16px;
      background-color: #666;
      border-radius: 50%;
      right: -10px;
      top: -3px;
    }
    
    .control-panel {
      width: 100%;
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    
    .control-knob {
      width: 80px;
      height: 80px;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0 10px;
    }
    
    .knob {
      width: 60px;
      height: 60px;
      background: radial-gradient(#26c73e, #631205);
      border-radius: 50%;
      position: relative;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      cursor: pointer;
    }
    
    .knob:before {
      content: "";
      position: absolute;
      width: 4px;
      height: 20px;
      background-color: #f4e1c1;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 2px;
    }
    
    .knob-label {
      margin-top: 8px;
      font-size: 14px;
      color: #f4e1c1;
      text-align: center;
    }
    
    button {
      background-color: #106517;
      color: #f4e1c1;
      border: none;
      padding: 7px 24px;
      font-family: 'Courier New', monospace;
      cursor: pointer;
      border-radius: 5px;
      box-shadow: 0 4px 0 #032502;
      transition: all 0.2s;
      font-size: 14px;
      margin: 0 8px;
      font-weight: bold;
      letter-spacing: 1px;
    }
    
    button:hover {
      background-color: #298b13;
      transform: translateY(-2px);
    }
    
    button:active {
      transform: translateY(4px);
      box-shadow: none;
    }
    
    .button-pressed {
      transform: translateY(4px);
      box-shadow: none;
      background-color: #033a05;
    }
    
    .worn-effect {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      background: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/g%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity: 0.3;
      z-index: 40;
    }
    
    .now-playing {
      width: 95%;
      margin-top: 20px;
      color: #f9ecd5;
      background-color: rgba(0, 60, 33, 0.5);
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      font-family: 'Courier New', monospace;
      letter-spacing: 1px;
      position: relative;
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
    }
    
    .now-playing-title {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .now-playing-artist {
      font-size: 16px;
      font-style: italic;
    }
    
    .now-playing-time {
      font-size: 14px;
      margin-top: 8px;
      font-family: monospace;
    }
    
    .progress-bar {
      width: 100%;
      height: 20px;
      background-color: #0b5e0bb5;
      margin-top: 15px;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.9);
    }
    
    .progress {
      height: 100%;
      background: linear-gradient(to right, #429646, #075f04);
      width: 0;
      transition: width 0.1s;
      position: relative;
    }
    
    .progress:after {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 2px;
      height: 100%;
      background-color: #f4e1c1;
    }
    
    .volume-control {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 15px;
      gap: 10px;
    }
    
    .volume-slider {
      width: 200px;
      height: 5px;
      -webkit-appearance: none;
      appearance: none;
      background-color: #053f0c9d;
      border-radius: 5px;
      outline: none;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.959);
    }
    
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background-color: #f8ecd7;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.8);
    }
    
    .volume-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background-color: #f4e1c1;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    }
    
    .add-song-panel {
      background-color: #dae3d5;
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      border: 2px solid #558b2f;
      min-height: 50px;
    }
    
    .add-song-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    input, textarea {
      padding: 10px;
      border: 2px solid #558b2f;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      background-color: #fbf6ed;
      color: #558b2f;
      transition: all 0.3s;
    }
    
    input:focus, textarea:focus {
      outline: none;
      box-shadow: 0 0 8px rgba(19, 139, 73, 0.5);
      border-color: #126305;
    }
    
    label {
      font-weight: bold;
      margin-bottom: 5px;
      display: block;
    }
    
    .scratches {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: 0.05;
      pointer-events: none;
      mix-blend-mode: overlay;
      z-index: 30;
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10,50 l80,0' stroke='%23fff' stroke-width='0.5'/%3E%3Cpath d='M30,20 l40,60' stroke='%23fff' stroke-width='0.5'/%3E%3Cpath d='M70,30 l-40,40' stroke='%23fff' stroke-width='0.5'/%3E%3C/svg%3E");
    }
    
    .wobble {
      animation: wobble 3s infinite ease-in-out;
    }
    
    @keyframes wobble {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      33% { transform: translate(-50%, -50%) rotate(0.3deg); }
      66% { transform: translate(-50%, -50%) rotate(-0.3deg); }
      100% { transform: translate(-50%, -50%) rotate(0deg); }
    }
    
    .spinning {
      animation: spin 6s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: translate(-50%, -50%) rotate(0deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    #youtubePlayer {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 200px;
      height: 200px;
      opacity: 0.0;
      z-index: 100;
      transform: scale(0.5);
      transform-origin: bottom right;
    }
    
    .collection-title {
      font-size: 1.8rem;
      color: #fffcf7;
      background-color: #37693f;
      padding: 10px;
      margin: 0 0 10px 0;
      text-align: center;
      border-radius: 5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .empty-collection {
      text-align: center;
      padding: 50px 20px;
      color: rgba(248, 247, 245, 0.893);
      font-style: italic;
    }
    
    .vinyl-grooves {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      pointer-events: none;
      background: repeating-radial-gradient(
        circle at 50% 50%,
        rgba(0, 0, 0, 0),
        rgba(0, 0, 0, 0) 5px,
        rgba(0, 0, 0, 0.1) 5px,
        rgba(0, 0, 0, 0.1) 6px
      );
      z-index: 15;
    }
    
    .album-info-container {
      background-color: rgba(0, 0, 0, 0.7);
      padding: 8px;
      border-radius: 3px;
      position: absolute;
      bottom: 10px;
      width: 85%;
    }
    
    .album-title {
      font-weight: bold;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .album-artist {
      font-size: 12px;
      opacity: 0.8;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Responsive design improvements */
    @media (max-width: 1100px) {
      .main-container {
        flex-direction: column;
      }
      
      .shelf-container {
        width: 100%;
        order: 2;
      }
      
      .player-container {
        order: 1;
      }
      
      .shelf {
        height: 350px;
      }
      
      .albums-container {
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .album {
        width: 200px;
        height: 200px;
      }
    }
    
    @media (max-width: 600px) {
      .turntable-base {
        width: 250px;
        height: 250px;
      }
      
      .platter {
        width: 200px;
        height: 200px;
      }
      
      .record {
        width: 180px;
        height: 180px;
      }
      
      .record-label {
        width: 60px;
        height: 60px;
      }
      
      .control-panel {
        flex-wrap: wrap;
      }
      
      button {
        padding: 10px 15px;
        font-size: 12px;
        margin: 5px;
      }
      
      .album {
        width: 150px;
        height: 150px;
      }
    }

    .home-button-container {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 100;
  }
  
  .home-button {
    background-color: #5eaf4d;
    color: #f9f3e9;
    border: none;
    padding: 5px 16px;
    font-family: 'Courier New', monospace;
    cursor: pointer;
    border-radius: 5px;
    box-shadow: 0 4px 0 #032502;
    transition: all 0.2s;
    font-size: 13px;
    font-weight: bold;
    letter-spacing: 1px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .home-button:hover {
    background-color: #298b13;
    transform: translateY(-2px);
  }
  
  .home-button:active {
    transform: translateY(4px);
    box-shadow: none;
  }
  
  .home-icon {
    font-size: 20px;
  }
  
  @media (max-width: 600px) {
    .home-button-container {
      top: 10px;
      left: 10px;
    }
    
    .home-button {
      padding: 8px 12px;
      font-size: 14px;
    }
  }
    </style>
</head>
<body>
  <header>
    <h1>Whispers Of Soul</h1>
    <div class="subtitle">Music Edition</div>
  </header>
  <pre></pre>
    <div class="home-button-container">
      <button id="backHomeBtn" class="home-button">
        <span class="home-icon">⌂</span> Back to Dashboard
      </button>
    </div>
  
  
  <div class="main-container">
    <div class="player-container">
      <div class="player">
        <div class="worn-effect"></div>
        <div class="player-cabinet">
          <div class="turntable-base">
            <div class="scratches"></div>
            <div class="platter"></div>
            <div class="record" id="record">
              <div class="vinyl-grooves"></div>
              <div class="record-label" id="recordLabel"></div>
            </div>
            <div class="spindle"></div>
            
            <div class="turntable-arm-base">
              <div class="turntable-arm" id="arm">
                <div class="arm-head">
                  <div class="needle"></div>
                </div>
                <div class="counterweight"></div>
              </div>
            </div>
          </div>
          
          <div class="now-playing" id="nowPlaying">
            <div class="now-playing-title">Nothing playing yet...</div>
            <div class="now-playing-artist"></div>
            <div class="now-playing-time" id="playingTime">00:00 / 00:00</div>
          </div>
          
          <div class="progress-bar" id="progressBarContainer">
            <div class="progress" id="progressBar"></div>
          </div>
          
          <div class="control-panel">
            <button id="playBtn">▶ Play</button>
            <button id="pauseBtn">❚❚ Pause</button>
            <button id="stopBtn">■ Stop</button>
            <button id="muteBtn">🔊 Mute</button>
          </div>
          
          <div class="volume-control">
            <span>Volume:</span>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="75">
          </div>
        </div>
      </div>

      <div class="add-song-panel">
        <h3>Add YouTube Music to Your Shelf</h3>
        <div class="add-song-form">
          <div>
            <label for="videoUrl">YouTube URL:</label>
            <input type="text" id="videoUrl" placeholder="Paste YouTube video URL">
          </div>
          
          <div>
            <label for="songTitle">Song Title (optional):</label>
            <input type="text" id="songTitle" placeholder="Enter song title">
          </div>
          
          <div>
            <label for="artistName">Artist (optional):</label>
            <input type="text" id="artistName" placeholder="Enter artist name">
          </div>
          
          <button id="addSongBtn">Add to Shelf</button>
        </div>
      </div>
    </div>
    
    <div class="shelf-container">
      <div class="collection-title">Your Collection</div>
      <div class="shelf" id="albumShelf">
        <div class="albums-container" id="albumsContainer">
          <div class="empty-collection" id="emptyCollection">
            Your shelf is empty. Add some YouTube songs!
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div id="youtubePlayer"></div>

  <script>
      let player;
    let tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    let firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // Player variables
    let isPlaying = false;
    let isMuted = false;
    let currentAlbum = null;
    let albums = [];
    
    // DOM Elements
    const record = document.getElementById('record');
    const recordLabel = document.getElementById('recordLabel');
    const arm = document.getElementById('arm');
    const progressBar = document.getElementById('progressBar');
    const progressBarContainer = document.getElementById('progressBarContainer');
    const playingTime = document.getElementById('playingTime');
    const nowPlaying = document.getElementById('nowPlaying');
    const albumShelf = document.getElementById('albumShelf');
    const albumsContainer = document.getElementById('albumsContainer');
    const emptyCollection = document.getElementById('emptyCollection');
    
    // Buttons
    const playBtn = document.getElementById('playBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const stopBtn = document.getElementById('stopBtn');
    const muteBtn = document.getElementById('muteBtn');
    const volumeSlider = document.getElementById('volumeSlider');
    const addSongBtn = document.getElementById('addSongBtn');
    
    // Default Albums - Define them before onYouTubeIframeAPIReady
    const DEFAULT_ALBUMS = [
      {
        id: 'default_1',
        isDefault: true,
        title:'Gayatri Mantra 108 Times',
        artist:'Meditative India',
        videoId:'GEVvyIrQZnA',
        thumbnail:'https://i.pinimg.com/736x/9c/c4/b0/9cc4b0f05588c8584eebb8224727dee4.jpg',
        videoUrl:'https://youtu.be/GEVvyIrQZnA?si=MHPopDwOtupjO0Ia', 
      },
      { 
        id: 'default_2',
        isDefault: true,
        title: 'Nature Sound - WaterFalls', 
        artist: '321 Relaxing', 
        videoId: 'lE6RYpe9IT0',
        thumbnail: 'https://i.pinimg.com/736x/02/59/69/0259699a168aea21ba838cd4873a1fdc.jpg',
        videoUrl: 'https://youtu.be/lE6RYpe9IT0?si=UHpgMcNgdcDjrhyu',
      },
      {
        id: 'default_3',
        isDefault: true,
        title:'Study Alpha Waves',
        artist:'Study Music',
        videoId:'LZ1xKB5SrA8',
        thumbnail:'https://i.pinimg.com/736x/99/1d/38/991d381c0d1b8d19fdde517abe835468.jpg',
        videoUrl:'https://youtu.be/LZ1xKB5SrA8?si=7fMnpSh2NUDmonWh',
      },
      { 
        id: 'default_4',
        isDefault: true,
        title: 'Relaxation Music', 
        artist: 'Peter B. Helland', 
        videoId: '1ZYbU82GVz4',
        thumbnail: 'https://i.pinimg.com/736x/80/8a/b4/808ab40453e9d3905c4762092c0eec3e.jpg',
        videoUrl: 'https://youtu.be/1ZYbU82GVz4?si=VHEBDThtS_GlpL4V',
      },
      {
        id: 'default_5',
        isDefault: true,
        title:'Mahamrityunjaya Mantra',
        artist:'Sounds Of Isha',
        videoId:'OV9LXGOXjgs',
        thumbnail:'https://i.pinimg.com/736x/fc/c5/a9/fcc5a99da8d6cb23e95315e5865921e7.jpg', 
        videoUrl:'https://youtu.be/OV9LXGOXjgs?si=fab_ShMbbf9t5lmu',
      },
      { 
        id: 'default_6',
        isDefault: true,
        title: 'Smooth Coffee Jazz', 
        artist: 'Coffee Jazz Music', 
        videoId: 'hk6hNmMeThM',
        thumbnail: 'https://i.pinimg.com/736x/3d/ad/6e/3dad6e68c9110945f69ef8d7287473f3.jpg',
        videoUrl: 'https://youtu.be/hk6hNmMeThM?si=NHhq81bQ0NEiT32H',
      },
      {
        id: 'default_7',
        isDefault: true,
        title:'OM Chanting @ 417Hz',
        artist:'Meditative Mind',
        videoId:'8sYK7lm3UKg',
        thumbnail:'https://i.pinimg.com/736x/00/87/ec/0087ece015e671c9c7fe09821820f695.jpg',
        videoUrl:'https://youtu.be/8sYK7lm3UKg?si=qoW2c5H87fvd201R',
      },
      {
        id: 'default_8',
        isDefault: true,
        title:'Mantras For Deep Inner Peace',
        artist:'Meditative Minds',
        videoId:'zwTGyO3MdP4',
        thumbnail:'https://i.pinimg.com/736x/9f/09/25/9f09252a1e81b7f05e56d01e8f417aff.jpg',
        videoUrl:'https://youtu.be/zwTGyO3MdP4?si=QIFD5t6gfgAMiZXb',
      },
    ];
    
    // Initialize YouTube API
    function onYouTubeIframeAPIReady() {
      player = new YT.Player('youtubePlayer', {
        height: '200',
        width: '200',
        videoId: '',
        playerVars: {
          'playsinline': 1,
          'controls': 0,
          'disablekb': 1,
          'fs': 0
        },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange
        }
      });
    }
    
    function onPlayerReady(event) {
      // Set initial volume
      player.setVolume(volumeSlider.value);
      
      // Load saved albums
      loadAlbums();
    }
    
    function onPlayerStateChange(event) {
      // YT.PlayerState.ENDED = 0
      if (event.data === 0) {
        stopPlayback();
      }
      
      // YT.PlayerState.PLAYING = 1
      if (event.data === 1) {
        isPlaying = true;
        playBtn.classList.add('button-pressed');
        pauseBtn.classList.remove('button-pressed');
        record.classList.add('spinning');
        arm.style.transform = 'rotate(10deg)';
        updatePlayingInfo();
      }
      
      // YT.PlayerState.PAUSED = 2
      if (event.data === 2) {
        isPlaying = false;
        playBtn.classList.remove('button-pressed');
        pauseBtn.classList.add('button-pressed');
        record.classList.remove('spinning');
      }
    }
    
    // Play functions
    function playVideo() {
      if (player && currentAlbum) {
        player.playVideo();
        startProgressUpdate();
      }
    }
    
    function pauseVideo() {
      if (player) {
        player.pauseVideo();
        stopProgressUpdate();
      }
    }
    
    function stopPlayback() {
      if (player) {
        player.stopVideo();
        stopProgressUpdate();
        resetPlayback();
      }
    }
    
    function resetPlayback() {
      isPlaying = false;
      playBtn.classList.remove('button-pressed');
      pauseBtn.classList.remove('button-pressed');
      stopBtn.classList.remove('button-pressed');
      record.classList.remove('spinning');
      arm.style.transform = 'rotate(-30deg)';
      progressBar.style.width = '0%';
      playingTime.textContent = '00:00 / 00:00';
    }
    
    // Progress bar updates
    let progressInterval;
    
    function startProgressUpdate() {
      progressInterval = setInterval(updateProgress, 100);
    }
    
    function stopProgressUpdate() {
      clearInterval(progressInterval);
    }
    
    function updateProgress() {
      if (player && player.getCurrentTime && player.getDuration) {
        const currentTime = player.getCurrentTime();
        const duration = player.getDuration();
        const percentage = (currentTime / duration) * 100;
        
        progressBar.style.width = percentage + '%';
        
        const currentMin = Math.floor(currentTime / 60);
        const currentSec = Math.floor(currentTime % 60);
        const durationMin = Math.floor(duration / 60);
        const durationSec = Math.floor(duration % 60);
        
        playingTime.textContent = `${currentMin.toString().padStart(2, '0')}:${currentSec.toString().padStart(2, '0')} / ${durationMin.toString().padStart(2, '0')}:${durationSec.toString().padStart(2, '0')}`;
      }
    }
    
    // Volume control
    function updateVolume() {
      if (player) {
        player.setVolume(volumeSlider.value);
      }
    }
    
    function toggleMute() {
      if (player) {
        if (isMuted) {
          player.unMute();
          volumeSlider.disabled = false;
          muteBtn.textContent = '🔊 Mute';
        } else {
          player.mute();
          volumeSlider.disabled = true;
          muteBtn.textContent = '🔈 Unmute';
        }
        isMuted = !isMuted;
      }
    }
    
    // Album management
    function addAlbum() {
      const videoUrl = document.getElementById('videoUrl').value;
      let songTitle = document.getElementById('songTitle').value;
      let artistName = document.getElementById('artistName').value;
      
      if (!videoUrl) {
        alert("Please enter a YouTube URL");
        return;
      }
      
      // Extract video ID from URL
      const videoId = extractVideoId(videoUrl);
      
      if (!videoId) {
        alert("Invalid YouTube URL");
        return;
      }
      
      // If title or artist are empty, fetch from YouTube
      if (!songTitle || !artistName) {
        fetchVideoInfo(videoId, function(info) {
          if (!songTitle) songTitle = info.title || 'Unknown Title';
          if (!artistName) artistName = info.author || 'Unknown Artist';
          
          createAlbum(videoId, songTitle, artistName);
        });
      } else {
        createAlbum(videoId, songTitle, artistName);
      }
    }
    
    function createAlbum(videoId, title, artist) {
      // Generate thumbnail URL
      const thumbnailUrl = `https://img.youtube.com/vi/${videoId}/0.jpg`;
      
      // Create new album object
      const album = {
        id: Date.now().toString(),
        videoId: videoId,
        title: title,
        artist: artist,
        thumbnail: thumbnailUrl
      };
      
      albums.push(album);
      
      // Add to shelf
      renderAlbum(album);
      
      // Save to local storage
      saveAlbums();
      
      // Clear form
      document.getElementById('videoUrl').value = '';
      document.getElementById('songTitle').value = '';
      document.getElementById('artistName').value = '';
      
      // Remove empty collection message if this is the first album
      if (albums.length === 1) {
        emptyCollection.style.display = 'none';
      }
    }
    
    function renderAlbum(album) {
      const albumElement = document.createElement('div');
      albumElement.className = 'album';
      albumElement.dataset.id = album.id;
      albumElement.style.backgroundImage = `url(${album.thumbnail})`;
      
      // Add a special class for default albums if needed
      if (album.isDefault) {
        albumElement.classList.add('default-album');
      }

      // Add album info
      albumElement.innerHTML = `
        <button class="remove-button" data-id="${album.id}">×</button>
        <div class="album-info-container">
          <div class="album-title">${album.title}</div>
          <div class="album-artist">${album.artist}</div>
        </div>
      `;
        
      // Click event
      albumElement.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-button')) {
          return; // Let the remove button handler deal with this
        }
        loadAlbum(album);
      });
      
      // Remove button event
      const removeBtn = albumElement.querySelector('.remove-button');
      removeBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        removeAlbum(album.id);
      });
      
      albumsContainer.appendChild(albumElement);
      
      // Add drag events to the new album element
      addDragEvents(albumElement);
    }
    
    function loadAlbum(album) {
      currentAlbum = album;
      
      // Stop current playback
      stopPlayback();
      
      // Update record appearance
      record.style.backgroundImage = `url(${album.thumbnail})`;
      recordLabel.style.backgroundImage = `url(${album.thumbnail})`;
      
      // Update now playing info
      const titleElement = nowPlaying.querySelector('.now-playing-title');
      const artistElement = nowPlaying.querySelector('.now-playing-artist');
      
      titleElement.textContent = album.title;
      artistElement.textContent = album.artist;
      
      // Load video in player
      player.loadVideoById(album.videoId);
      
      // Handle autoplay restrictions
      setTimeout(() => {
        playVideo();
      }, 500);
    }
    
    function removeAlbum(id) {
      // If this album is currently playing, stop playback
      if (currentAlbum && currentAlbum.id === id) {
        stopPlayback();
        currentAlbum = null;
        
        // Reset player visuals
        record.style.backgroundImage = '';
        recordLabel.style.backgroundImage = '';
        
        // Reset now playing info
        const titleElement = nowPlaying.querySelector('.now-playing-title');
        const artistElement = nowPlaying.querySelector('.now-playing-artist');
        
        titleElement.textContent = 'Nothing playing yet...';
        artistElement.textContent = '';
      }
      
      // Remove from array
      albums = albums.filter(album => album.id !== id);
      
      // Remove from DOM
      const albumElement = document.querySelector(`.album[data-id="${id}"]`);
      if (albumElement) {
        albumElement.remove();
      }
      
      // Save to local storage
      saveAlbums();
      
      // Show empty collection message if no albums left
      if (albums.length === 0) {
        emptyCollection.style.display = 'block';
      }
    }
    
    // Helper functions
    function extractVideoId(url) {
      const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
      const match = url.match(regExp);
      return (match && match[7].length === 11) ? match[7] : null;
    }
    
    function fetchVideoInfo(videoId, callback) {
      // In a real app, you would make an API call to get video info
      // Since we can't do that here, we'll just use placeholder data
      callback({
        title: 'YouTube Video',
        author: 'YouTube Creator'
      });
    }
    
    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = Math.floor(seconds % 60);
      return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
    
    function updatePlayingInfo() {
      if (currentAlbum) {
        nowPlaying.querySelector('.now-playing-title').textContent = currentAlbum.title;
        nowPlaying.querySelector('.now-playing-artist').textContent = currentAlbum.artist;
      }
    }
    
    // Local storage functions
    function saveAlbums() {
      // Filter out default albums before saving
      const userAlbums = albums.filter(album => !album.isDefault);
      localStorage.setItem('retroGroovesAlbums', JSON.stringify(userAlbums));
    }
    
    // Load albums function
    function loadAlbums() {
      // Clear current albums display
      albumsContainer.innerHTML = '';
      
      // First load user's saved albums
      const savedAlbums = localStorage.getItem('retroGroovesAlbums');
      let userAlbums = [];
      
      if (savedAlbums) {
        userAlbums = JSON.parse(savedAlbums);
        
        // Filter out any default albums from saved albums to avoid duplicates
        userAlbums = userAlbums.filter(album => !album.id.startsWith('default'));
      }
      
      // Always add default albums at the beginning
      albums = [...DEFAULT_ALBUMS, ...userAlbums];
      
      if (albums.length > 0) {
        emptyCollection.style.display = 'none';
        
        // Render all albums
        albums.forEach(album => {
          renderAlbum(album);
        });
      }
    }
    
    // Progress bar seeking
    progressBarContainer.addEventListener('click', function(e) {
      if (player && player.getDuration) {
        const clickPosition = (e.offsetX / this.offsetWidth);
        const seekTime = player.getDuration() * clickPosition;
        player.seekTo(seekTime, true);
      }
    });
    
    // Event listeners
    playBtn.addEventListener('click', playVideo);
    pauseBtn.addEventListener('click', pauseVideo);
    stopBtn.addEventListener('click', stopPlayback);
    muteBtn.addEventListener('click', toggleMute);
    volumeSlider.addEventListener('input', updateVolume);
    addSongBtn.addEventListener('click', addAlbum);
    
    // Make records draggable for reordering
    let draggedElement = null;
    
    function handleDragStart(e) {
      draggedElement = this;
      this.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/html', this.innerHTML);
    }
    
    function handleDragEnd() {
      this.classList.remove('dragging');
    }
    
    function handleDragOver(e) {
      if (e.preventDefault) {
        e.preventDefault();
      }
      e.dataTransfer.dropEffect = 'move';
      return false;
    }
    
    function handleDragEnter() {
      this.classList.add('over');
    }
    
    function handleDragLeave() {
      this.classList.remove('over');
    }
    
    function handleDrop(e) {
      if (e.stopPropagation) {
        e.stopPropagation();
      }
      
      if (draggedElement !== this) {
        // Get positions
        const allAlbums = document.querySelectorAll('.album');
        const draggedIndex = Array.from(allAlbums).indexOf(draggedElement);
        const droppedIndex = Array.from(allAlbums).indexOf(this);
        
        // Reorder in DOM
        if (draggedIndex < droppedIndex) {
          this.parentNode.insertBefore(draggedElement, this.nextSibling);
        } else {
          this.parentNode.insertBefore(draggedElement, this);
        }
        
        // Reorder in array
        const movedAlbum = albums.splice(draggedIndex, 1)[0];
        albums.splice(droppedIndex, 0, movedAlbum);
        
        // Save new order
        saveAlbums();
      }
      
      return false;
    }
    
    // Initialize drag-and-drop
    function addDragEvents(element) {
      element.draggable = true;
      element.addEventListener('dragstart', handleDragStart, false);
      element.addEventListener('dragend', handleDragEnd, false);
      element.addEventListener('dragover', handleDragOver, false);
      element.addEventListener('dragenter', handleDragEnter, false);
      element.addEventListener('dragleave', handleDragLeave, false);
      element.addEventListener('drop', handleDrop, false);
    }
    
    // Add drag events to any new albums
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'childList') {
          Array.from(mutation.addedNodes).forEach(node => {
            if (node.nodeType === 1 && node.classList.contains('album')) {
              addDragEvents(node);
            }
          });
        }
      });
    });
    
    observer.observe(albumsContainer, { childList: true });

    document.getElementById('backHomeBtn').addEventListener('click', function() {
      window.location.href = 'home.html';
    });
    
    // Call loadAlbums directly to display default albums even if YouTube API loading is delayed
    loadAlbums();
  </script>
</body>
</html>